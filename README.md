# Windows定时电源管理工具

## 功能介绍
这是一个功能全面的Windows定时电源管理工具，支持三种电源操作和两种时间模式：

### 支持的电源操作：
- **休眠 (Hibernate)**：保存当前状态到硬盘，完全断电，恢复速度较慢但最省电
- **睡眠 (Sleep)**：保存当前状态到内存，低功耗待机，恢复速度快
- **关机 (Shutdown)**：完全关闭系统，需要重新开机

### 支持的时间模式：
- **倒计时模式**：从现在开始计时，经过指定时间后执行操作（例如：30分钟后关机）
- **定时模式**：设置具体时间点，到指定时间执行操作（例如：晚上11点整休眠）

## 运行方法
1. 确保已安装Python（建议3.6或更高版本）
2. 双击运行 `power_scheduler.py` 文件
3. 或者在命令行中运行：`python power_scheduler.py`

## 使用步骤

### 基本操作步骤
1. **选择电源操作**：在顶部选择要执行的操作（休眠/睡眠/关机）
2. **选择时间模式**：选择倒计时模式或定时模式
3. **设置时间**：
   - 倒计时模式：设置小时、分钟、秒
   - 定时模式：设置具体的小时和分钟（24小时制）
4. **启动定时**：点击"启动定时"按钮开始
5. **监控进度**：界面上会显示剩余时间和目标时间
6. **确认操作**：时间到时会弹出确认对话框，确认后执行操作

### 详细使用示例

#### 示例1：30分钟后休眠
1. 选择"休眠 (Hibernate)"
2. 选择"倒计时模式"
3. 小时：0，分钟：30，秒：0
4. 点击"启动定时"

#### 示例2：每天晚上11点关机
1. 选择"关机 (Shutdown)"
2. 选择"定时模式"
3. 时：23，分：0
4. 点击"启动定时"

#### 示例3：2小时后睡眠
1. 选择"睡眠 (Sleep)"
2. 选择"倒计时模式"
3. 小时：2，分钟：0，秒：0
4. 点击"启动定时"

## 界面特性
- ✅ **直观的图形界面**：操作简单，一目了然
- ✅ **实时倒计时显示**：显示剩余时间（时:分:秒）
- ✅ **目标时间显示**：显示具体的执行时间点
- ✅ **操作工具提示**：鼠标悬停显示各操作的详细说明
- ✅ **灵活的时间设置**：支持小时、分钟、秒的精确设置
- ✅ **随时可取消**：运行中可点击"取消定时"按钮
- ✅ **二次确认保护**：执行前弹出确认对话框，防止误操作

## 注意事项
1. **系统要求**：此工具仅支持Windows系统
2. **电源功能**：确保你的电脑支持相应的电源功能（休眠/睡眠/关机）
3. **数据安全**：执行前请保存好重要文件和数据
4. **权限设置**：如果某些功能无效，可能需要管理员权限

## 故障排除

### 休眠功能无效
在管理员权限的命令提示符中运行：
```cmd
powercfg /hibernate on
```

### 睡眠功能无效
1. 检查系统是否启用睡眠功能
2. 在电源选项中确认睡眠设置

### 关机功能无效
确保没有重要程序阻止关机，或者使用管理员权限运行

### 程序无法启动
1. 确认Python环境是否正确安装（建议3.6或更高版本）
2. 确认tkinter库是否可用（通常Python自带）

## 技术说明

### 命令说明
- **休眠**：使用 `shutdown /h` 命令
- **睡眠**：使用 `rundll32.exe powrprof.dll,SetSuspendState 0,1,0` 命令
- **关机**：使用 `shutdown /s /t 0` 命令

### 文件说明
- `power_scheduler.py` - 主程序文件
- `README.md` - 本使用说明文档

### 项目结构
```
D:\Code\Claude code\Project\Windows定时电源管理工具\
├── power_scheduler.py    # 主程序
└── README.md            # 说明文档
```

## 更新日志
- **v1.0** (2025-11-20): 初始版本，支持定时休眠功能
- **v2.0** (2025-11-20): 增强版本，支持关机、睡眠、休眠三种操作，优化界面和用户体验